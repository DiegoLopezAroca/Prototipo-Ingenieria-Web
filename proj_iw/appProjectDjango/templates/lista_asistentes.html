{% load static i18n %}
{% load permisos_extras %}
<!DOCTYPE html>
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% blocktrans with nombre_evento=evento.nombre %}Asistentes – {{ nombre_evento }}{% endblocktrans %}</title>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
  <link rel="icon" href="{% static 'img/iconos/dios.png' %}">
</head>
<body>
<header class="site-header">
  <div class="wrap">
    <a class="brand" href="{% url 'index' %}">
      <img src="{% static 'img/iconos/peña.jpg' %}" alt="{% trans "Logo de la Peña El Revoque" %}" class="brand-logo">
      <span>{% trans "Peña El Revoque" %}</span>
    </a>
    <nav class="main-nav" aria-label="{% trans "Principal" %}">
      <a href="{% url 'index' %}">{% trans "Inicio" %}</a>
      <a href="{% url 'eventos' %}">{% trans "Eventos" %}</a>
      <a href="{% url 'socios' %}">{% trans "Socios" %}</a>
      <a href="{% url 'merchandising' %}">{% trans "Merchandising" %}</a>
      <a href="{% url 'cuotas' %}">{% trans "Cuotas" %}</a>
      <a href="{% url 'registros' %}">{% trans "Registro" %}</a>
    </nav>
    <div class="language-switcher">
      <form action="{% url 'set_language' %}" method="post" style="display: flex; gap: 0.3rem;">
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ request.get_full_path }}">
        <button type="submit" name="language" value="es" class="{% if LANGUAGE_CODE == 'es' %}active-lang{% endif %}">ES</button>
        <button type="submit" name="language" value="en" class="{% if LANGUAGE_CODE == 'en' %}active-lang{% endif %}">EN</button>
        <button type="submit" name="language" value="eu" class="{% if LANGUAGE_CODE == 'eu' %}active-lang{% endif %}">EU</button>
      </form>
    </div>
  </div>
</header>

<section class="hero">
  <div class="hero-inner">
    <h1>{% blocktrans with nombre_evento=evento.nombre %}Asistentes a {{ nombre_evento }}{% endblocktrans %}</h1>
    <h2>{% blocktrans with lugar=evento.lugar fecha=evento.fecha %}{{ lugar }} – {{ fecha|date:"d/m/Y" }}{% endblocktrans %}</h2>
  </div>
</section>

<main class="wrap">
  {% if asistentes %}
    <table id="asistentes">
      <thead>
        <tr>
          <th>{% trans "Nombre" %}</th>
          <th>{% trans "Apellidos" %}</th>
          <th>{% trans "Fecha de registro" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for a in asistentes %}
          <tr>
            <td>{{ a.socio.nombre }}</td>
            <td>{{ a.socio.apellido }} {{ a.socio.segundo_apellido }}</td>
            <td>{{ a.fecha_registro|date:"d/m/Y H:i" }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>{% trans "Aún no hay asistentes registrados." %}</p>
  {% endif %}

  <p><a href="{% url 'eventos' %}#fiestashervias-{{ evento.id }}" class="btn">{% trans "Volver al menú de eventos" %}</a></p>
  
  {% if user|es_gestor %}
      <p>
          <a href="{% url 'editar_asistentes' evento.id %}" class="btn btn-editar">{% trans "Editar asistentes" %}</a>
      </p>
  {% endif %}
</main>

<footer class="site-footer">
  <p>&copy; 2025 {% trans "Peña El Revoque. Todos los derechos reservados." %}</p>
</footer>
</body>
</html>
